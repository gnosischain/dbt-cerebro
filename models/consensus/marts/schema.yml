version: 2
models:

- name: api_consensus_attestations_daily
  description: Daily aggregated counts of consensus attestations, providing a business-facing overview of attestation activity.
  columns:
  - name: date
    description: Date of the aggregation, formatted as YYYY-MM-DD.
    data_type: Date
  - name: inclusion_delay
    description: Delay in slots between attestation inclusion and the target slot.
    data_type: UInt64
  - name: cnt
    description: Total number of attestations included on the given date with the specified delay.
    data_type: UInt64
  config:
    access: public
    materialized: view
    tags:
    - production
    - consensus
    - attestations
  meta:
    owner: analytics-team
    authoritative: false
    generated_by: schema-writer
- name: api_consensus_blob_commitments_daily
  description: Daily aggregated count of blob commitments in the consensus layer, used for monitoring blob commitment activity.
  columns:
  - name: date
    description: Date of the aggregation in YYYY-MM-DD format.
    data_type: Date
  - name: value
    description: Count of blob commitments for the given date.
    data_type: UInt64
  config:
    access: public
    materialized: view
    tags:
    - production
    - consensus
    - blob_commitments
  meta:
    owner: analytics-team
    authoritative: false
    generated_by: schema-writer
- name: api_consensus_blocks_daily
  description: Daily aggregation of consensus blocks data, including produced and missed blocks.
  columns:
  - name: date
    description: Date of the aggregation in YYYY-MM-DD format.
    data_type: Date
  - name: label
    description: Label indicating 'produced' or 'missed' blocks.
    data_type: String
  - name: value
    description: Count of blocks corresponding to the label for the given date.
    data_type: UInt64
  config:
    access: public
    tags:
    - production
    - consensus
    - blocks
    materialized: view
  meta:
    owner: analytics_team
    authoritative: false
    generated_by: schema-writer
- name: api_consensus_credentials_daily
  description: Daily aggregated data of consensus credentials, including counts and percentages, used for business insights and reporting.
  columns:
  - name: date
    description: Date of the record in YYYY-MM-DD format.
    data_type: DateTime
  - name: credentials_type
    description: Type/category of credentials, e.g., validator, proposer.
    data_type: String
  - name: cnt
    description: Count of credentials of the specified type for the date.
    data_type: UInt64
  - name: pct
    description: Percentage of credentials of this type relative to total on the date.
    data_type: Float64
  config:
    access: public
    materialized: view
    tags:
    - production
    - consensus
    - credentials
  meta:
    owner: analytics-team
    authoritative: false
    generated_by: schema-writer
- name: api_consensus_credentials_latest
  description: A model representing the latest consensus credentials, including credentials type and count, derived from the most recent date in the source data.
  columns:
  - name: credentials_type
    description: Type of credentials (e.g., API key, token).
    data_type: String
  - name: cnt
    description: Count of credentials of this type.
    data_type: UInt64
  config:
    access: public
    materialized: view
    tags:
    - production
    - consensus
    - credentials
  meta:
    owner: analytics_team
    authoritative: false
    generated_by: schema-writer
- name: api_consensus_deposits_withdrawls_cnt_daily
  description: Daily count of deposits and withdrawals in the consensus layer, aggregated per date and label for business insights.
  columns:
  - name: date
    description: Date of the aggregated data in YYYY-MM-DD format.
    data_type: DateTime
  - name: label
    description: Category label for the count, e.g., 'deposits' or 'withdrawals'.
    data_type: String
  - name: value
    description: Count of deposits or withdrawals for the given date and label.
    data_type: UInt64
  config:
    access: public
    materialized: view
    tags:
    - production
    - consensus
    - deposits_withdrawals
  meta:
    owner: analytics-team
    authoritative: false
    generated_by: schema-writer
- name: api_consensus_deposits_withdrawls_volume_daily
  description: Daily volume of deposits and withdrawals in the consensus layer, aggregated by date and label.
  columns:
  - name: date
    description: The date of the record, in UTC.
    data_type: DateTime
  - name: label
    description: Label categorizing the volume (e.g., 'deposits', 'withdrawals').
    data_type: String
  - name: value
    description: Total volume in wei for the given date and label.
    data_type: UInt64
  config:
    access: public
    materialized: view
    tags:
    - production
    - consensus
    - deposits_withdrawals
  meta:
    owner: analytics-team
    authoritative: false
    generated_by: schema-writer
- name: api_consensus_entry_queue_daily
  description: Daily aggregated data on consensus entry queue metrics, including validator counts and quantile statistics.
  columns:
  - name: date
    description: Date of the aggregation in UTC.
    data_type: DateTime
  - name: validator_count
    description: Number of validators active on the given date.
    data_type: UInt64
  - name: q05
    description: 5th percentile of the queue length.
    data_type: Float64
  - name: q10
    description: 10th percentile of the queue length.
    data_type: Float64
  - name: q25
    description: 25th percentile of the queue length.
    data_type: Float64
  - name: q50
    description: Median (50th percentile) of the queue length.
    data_type: Float64
  - name: q75
    description: 75th percentile of the queue length.
    data_type: Float64
  - name: q90
    description: 90th percentile of the queue length.
    data_type: Float64
  - name: q95
    description: 95th percentile of the queue length.
    data_type: Float64
  - name: mean
    description: Average queue length.
    data_type: Float64
  config:
    access: public
    tags:
    - production
    - consensus
    - entry_queue
    materialized: view
  meta:
    owner: analytics-team
    authoritative: false
    generated_by: schema-writer
- name: api_consensus_forks
  description: Model representing consensus forks with details such as name, version, digest, and epoch.
  columns:
  - name: fork_name
    description: Name of the fork (e.g., "Bellatrix", "Capella").
    data_type: String
  - name: fork_version
    description: Version label of the fork.
    data_type: String
  - name: fork_digest
    description: Unique digest identifier for the fork.
    data_type: String
  - name: fork_epoch
    description: Epoch number at which the fork occurred.
    data_type: UInt64
  config:
    access: public
    materialized: view
    tags:
    - production
    - consensus
    - forks
  meta:
    owner: analytics-team
    authoritative: false
    generated_by: schema-writer
- name: api_consensus_graffiti_cloud
  description: View aggregating graffiti and label data from consensus layer, ordered by label and value.
  columns:
  - name: label
    description: Label associated with graffiti, used for categorization.
    data_type: String
  - name: graffiti
    description: Graffiti content or tag.
    data_type: String
  - name: value
    description: Numeric or descriptive value associated with graffiti.
    data_type: String
  config:
    access: public
    materialized: view
    tags:
    - production
    - consensus
    - graffiti
  meta:
    owner: analytics-team
    authoritative: false
    generated_by: schema-writer
- name: api_consensus_graffiti_label_daily
  description: Aggregated daily counts of graffiti labels from consensus data, grouped by date and label.
  columns:
  - name: date
    description: Date of the aggregation in YYYY-MM-DD format.
    data_type: DateTime
  - name: label
    description: Graffiti label identifier.
    data_type: String
  - name: value
    description: Total count of graffiti labels for the given date and label.
    data_type: UInt64
  config:
    access: public
    materialized: view
    tags:
    - production
    - consensus
    - graffiti
  meta:
    owner: analytics-team
    authoritative: false
    generated_by: schema-writer
- name: api_consensus_info_active_ongoing_latest
  description: View providing the latest active and ongoing consensus info filtered where label equals 'active_ongoing'. Contains value and change percentage.
  columns:
  - name: value
    description: The main value representing consensus info, as selected in the SQL.
    data_type: String
  - name: change_pct
    description: Percentage change of the consensus metric, numeric value.
    data_type: Float64
  config:
    access: public
    materialized: view
    tags:
    - production
    - consensus
    - info
  meta:
    owner: analytics-team
    authoritative: false
    generated_by: schema-writer
- name: api_consensus_info_apy_latest
  description: View providing the latest APY7D consensus information, including value and change percentage.
  columns:
  - name: value
    description: The APY7D value in percentage points.
    data_type: Float64
  - name: change_pct
    description: Percentage change in APY7D from previous measurement.
    data_type: Float64
  config:
    access: public
    materialized: view
    tags:
    - production
    - consensus
    - info
  meta:
    owner: analytics-team
    authoritative: false
    generated_by: schema-writer
- name: api_consensus_info_deposits_cnt_latest
  description: Model providing the latest count of deposits with value and change percentage.
  columns:
  - name: value
    description: The deposit count value.
    data_type: UInt64
  - name: change_pct
    description: Percentage change in deposits compared to previous period.
    data_type: Float64
  config:
    access: public
    tags:
    - production
    - consensus
    - info
    materialized: view
  meta:
    owner: analytics-team
    authoritative: false
    generated_by: schema-writer
- name: api_consensus_info_withdrawls_cnt_latest
  description: This model provides the latest count of withdrawals from the consensus layer, filtered where label equals 'withdrawls_cnt'. It aggregates data from the `fct_consensus_info_latest` source, focusing on the `value` and `change_pct` columns for business insights into withdrawal activity.
  columns:
  - name: value
    description: The withdrawal count value for the latest consensus info.
    data_type: String
  - name: change_pct
    description: Percentage change in withdrawal count compared to previous period.
    data_type: String
  config:
    access: public
    materialized: view
  meta:
    owner: analytics_team
    authoritative: false
    generated_by: schema-writer
- name: api_consensus_staked_daily
  description: Daily snapshot of staked validator balances, derived from the int_consensus_validators_balances_daily model, representing effective balances divided by 32 for business insights.
  columns:
  - name: date
    description: Date of the snapshot.
    data_type: DateTime
  - name: value
    description: Effective staked balance divided by 32 (validator count), in units.
    data_type: Float64
  config:
    access: public
    materialized: view
    tags:
    - production
    - consensus
    - staked
  meta:
    owner: analytics-team
    authoritative: false
    generated_by: schema-writer
- name: api_consensus_validators_active_daily
  description: Daily count of active consensus validators filtered by status 'active_ongoing'.
  columns:
  - name: date
    description: The date representing the day of the activity, in YYYY-MM-DD format.
    data_type: Date
  - name: cnt
    description: Count of active validators for the given date.
    data_type: UInt64
  config:
    access: public
    materialized: view
    tags:
    - production
    - consensus
    - validators
  meta:
    owner: analytics-team
    authoritative: false
    generated_by: schema-writer
- name: api_consensus_validators_apy_daily
  description: Daily and 7-day moving average APY data for consensus validators, used for performance and health monitoring.
  columns:
  - name: date
    description: Date of the APY measurement.
    data_type: DateTime64(0, 'UTC')
  - name: label
    description: Label indicating the APY type, e.g., 'Daily' or '7DMA'.
    data_type: String
  - name: apy
    description: Annual Percentage Yield (APY) in percentage points.
    data_type: Float64
  config:
    access: public
    materialized: view
  meta:
    owner: analytics_team
    authoritative: false
    generated_by: schema-writer
- name: api_consensus_validators_apy_dist
  description: Distribution of validators' APY over time, based on consensus data.
  columns:
  - name: date
    description: Date of the APY distribution snapshot.
    data_type: DateTime64(0, 'UTC')
  - name: q05
    description: 5th percentile of validators' APY.
    data_type: Float64
  - name: q10
    description: 10th percentile of validators' APY.
    data_type: Float64
  - name: q25
    description: 25th percentile of validators' APY.
    data_type: Float64
  - name: q50
    description: 50th percentile (median) of validators' APY.
    data_type: Float64
  - name: q75
    description: 75th percentile of validators' APY.
    data_type: Float64
  - name: q90
    description: 90th percentile of validators' APY.
    data_type: Float64
  - name: q95
    description: 95th percentile of validators' APY.
    data_type: Float64
  config:
    access: public
    materialized: view
    tags:
    - production
    - consensus
    - validators_apy
  meta:
    owner: analytics-team
    authoritative: false
    generated_by: schema-writer
- name: api_consensus_validators_balances_daily
  description: Daily aggregated balances and effective balances for consensus validators, combining current balances and effective balances for business insights.
  columns:
  - name: date
    description: The date of the balance snapshot in YYYY-MM-DD format.
    data_type: DateTime
  - name: label
    description: Label indicating balance type ('balance' or 'eff. balance').
    data_type: String
  - name: value
    description: Numeric value of the balance in wei.
    data_type: UInt64
  config:
    access: public
    materialized: view
    tags:
    - production
    - consensus
    - validators_balances
  meta:
    owner: analytics-team
    authoritative: false
    generated_by: schema-writer
- name: api_consensus_validators_balances_dist_daily
  description: Daily distribution of validator balances derived from consensus data, including quantile metrics for analysis.
  columns:
  - name: date
    description: Date of the recorded balances in YYYY-MM-DD format.
    data_type: DateTime
  - name: q05
    description: 5th percentile of validator balances divided by 32, representing lower bound.
    data_type: Float64
  - name: q10
    description: 10th percentile of validator balances divided by 32.
    data_type: Float64
  - name: q25
    description: 25th percentile of validator balances divided by 32.
    data_type: Float64
  - name: q50
    description: Median (50th percentile) of validator balances divided by 32.
    data_type: Float64
  - name: q75
    description: 75th percentile of validator balances divided by 32.
    data_type: Float64
  - name: q90
    description: 90th percentile of validator balances divided by 32.
    data_type: Float64
  - name: q95
    description: 95th percentile of validator balances divided by 32.
    data_type: Float64
  config:
    access: public
    tags:
    - production
    - consensus
    - validators_balances
    materialized: view
  meta:
    owner: analytics-team
    authoritative: false
    generated_by: schema-writer
- name: api_consensus_validators_status_daily
  description: Daily status summary of consensus validators, excluding 'active_ongoing' and 'withdrawal_done' statuses, aggregated by date.
  columns:
  - name: date
    description: Date of the status record, in YYYY-MM-DD format.
    data_type: DateTime
  - name: status
    description: Validator status category (e.g., 'pending', 'active', etc.).
    data_type: String
  - name: cnt
    description: Count of validators in the given status on the date.
    data_type: UInt64
  config:
    access: public
    materialized: view
    tags:
    - production
    - consensus
    - validators
  meta:
    owner: analytics-team
    authoritative: false
    generated_by: schema-writer
- name: api_consensus_withdrawls_dist_daily
  description: Daily distribution of consensus-layer withdrawal data, including quantiles and related metrics.
  columns:
  - name: date
    description: Date of the distribution (YYYY-MM-DD).
    data_type: DateTime
  - name: q05
    description: 5th percentile value of withdrawal distribution.
    data_type: Float64
  - name: q10
    description: 10th percentile value of withdrawal distribution.
    data_type: Float64
  - name: q25
    description: 25th percentile value of withdrawal distribution.
    data_type: Float64
  - name: q50
    description: Median (50th percentile) of withdrawal distribution.
    data_type: Float64
  - name: q75
    description: 75th percentile value of withdrawal distribution.
    data_type: Float64
  - name: q90
    description: 90th percentile value of withdrawal distribution.
    data_type: Float64
  - name: q95
    description: 95th percentile value of withdrawal distribution.
    data_type: Float64
  config:
    access: public
    materialized: view
    tags:
    - production
    - consensus
    - withdrawls
  meta:
    owner: analytics-team
    authoritative: false
    generated_by: schema-writer
- name: fct_consensus_deposits_withdrawls_daily
  description: Business-facing table aggregating deposits and withdrawls per day with labels.
  columns:
  - name: date
    description: Date of the aggregation (UTC).
    data_type: DateTime
  - name: label
    description: 'Type of transaction: ''deposits'' or ''withdrawls''.'
    data_type: String
  - name: cnt
    description: Count of transactions for the given date and label.
    data_type: UInt64
  - name: total_amount
    description: Sum of amounts in wei for the transactions on the given date and label.
    data_type: UInt64
  config:
    access: public
    materialized: view
  meta:
    owner: analytics_team
    authoritative: false
    generated_by: schema-writer
- name: fct_consensus_forks
  description: Business-facing table aggregating fork information, including fork name, version, digest, epoch, and fork time, derived from consensus data sources.
  columns:
  - name: fork_name
    description: Name of the fork (e.g., Phase0, Altair, Bellatrix, Capella, Deneb, Electra, Fulu).
    data_type: String
  - name: fork_digest
    description: Unique digest identifier for the fork.
    data_type: String
  - name: fork_version
    description: Fork version string (e.g., 'PHASE0', 'Altair', etc.).
    data_type: String
  - name: fork_epoch
    description: Epoch at which the fork occurred, represented as a string.
    data_type: String
  - name: fork_time
    description: UTC timestamp when the fork occurred, derived from genesis time and epoch.
    data_type: DateTime
  config:
    access: public
    tags:
    - production
    - consensus
    - forks
    materialized: view
  meta:
    owner: analytics-team
    authoritative: false
    generated_by: schema-writer
- name: fct_consensus_graffiti_cloud
  description: Aggregated graffiti counts over different time windows, filtered to exclude 'None' graffiti entries.
  columns:
  - name: label
    description: Time window labels for graffiti counts ('7D', '30D', '90D', 'All').
    data_type: String
  - name: graffiti
    description: Graffiti string identifier.
    data_type: String
  - name: v_7d
    description: Sum of graffiti occurrences in the last 7 days.
    data_type: UInt64
  - name: v_30d
    description: Sum of graffiti occurrences in the last 30 days.
    data_type: UInt64
  - name: v_90d
    description: Sum of graffiti occurrences in the last 90 days.
    data_type: UInt64
  - name: v_all
    description: Total sum of graffiti occurrences across all time.
    data_type: UInt64
  config:
    access: public
    tags:
    - production
    - consensus
    - graffiti
    materialized: table
  meta:
    owner: analytics-team
    authoritative: false
    generated_by: schema-writer
- name: fct_consensus_info_latest
  description: Aggregated latest consensus layer statistics including deposits, withdrawals, APY, validator status, and staked balances, with comparisons over 7-day periods.
  columns:
  - name: label
    description: Identifier for the metric, e.g., deposits_cnt, withdrawls_total_amount, APY7D.
    data_type: String
  - name: value
    description: Numeric value of the metric; units vary per label.
    data_type: Float64
  - name: change_pct
    description: Percentage change over 7 days; null if denominator is zero.
    data_type: Float64
  config:
    access: public
    tags:
    - production
    - consensus
    - info
    materialized: view
  meta:
    owner: analytics-team
    authoritative: false
    generated_by: schema-writer
- name: fct_consensus_validators_apy_daily
  description: Daily computed APY and rate metrics for consensus validators, including 7-day moving averages and derived APY values, based on the latest data.
  columns:
  - name: date
    description: Date of the APY calculation in UTC.
    data_type: DateTime64(0, 'UTC')
  - name: balance
    description: Validator balance in wei.
    data_type: UInt64
  - name: rate
    description: Daily rate of validator rewards (decimal, e.g., 0.0001 for 0.01%).
    data_type: Float64
  - name: rate_7dma
    description: 7-day moving average of the daily rate.
    data_type: Float64
  - name: apy
    description: Calculated APY based on the daily rate.
    data_type: Float64
  - name: apy_7dma
    description: 7-day moving average of the APY.
    data_type: Float64
  config:
    access: public
    materialized: view
    tags:
    - production
    - consensus
    - validators_apy
  meta:
    owner: analytics-team
    authoritative: false
    generated_by: schema-writer
- name: api_consensus_info_staked_latest
  description: View providing the latest staked consensus information filtered where label is 'Staked'.
  columns:
  - name: value
    description: Numeric value representing the staked amount (in wei or relevant units).
    data_type: UInt64
  - name: change_pct
    description: Percentage change in the staked amount compared to previous measurement.
    data_type: Float64
  config:
    access: public
    materialized: view
    tags:
    - production
    - consensus
    - info
  meta:
    owner: analytics_team
    authoritative: false
    generated_by: schema-writer
